--2022-12-07 12:00:45--  http://atp-modelzoo-sh.oss-cn-shanghai.aliyuncs.com/release/easynlp_modelzoo/modelzoo_alibaba.json
Resolving atp-modelzoo-sh.oss-cn-shanghai.aliyuncs.com (atp-modelzoo-sh.oss-cn-shanghai.aliyuncs.com)... 47.101.88.27
Connecting to atp-modelzoo-sh.oss-cn-shanghai.aliyuncs.com (atp-modelzoo-sh.oss-cn-shanghai.aliyuncs.com)|47.101.88.27|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 6605 (6.5K) [application/json]
Saving to: ‘modelzoo_alibaba.json’

     0K ......                                                100%  681M=0s

2022-12-07 12:00:45 (681 MB/s) - ‘modelzoo_alibaba.json’ saved [6605/6605]

/apsarapangu/disk2/zhoujiyong.zjy/miniconda3/envs/ie/lib/python3.8/site-packages/torch/distributed/launch.py:178: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
[W socket.cpp:401] [c10d] The server socket cannot be initialized on [::]:52463 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:558] [c10d] The client socket cannot be initialized to connect to [localhost]:52463 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:558] [c10d] The client socket cannot be initialized to connect to [localhost]:52463 (errno: 97 - Address family not supported by protocol).
NOTE: if you wish to use GLM models, please refer to EasyNLP/examples/appzoo_tutorials/sequence_generation/README.md!
name 'deepspeed' is not defined
The following parameters are not recognized: []
------------------------ arguments ------------------------
  app_name ........................................ data_augmentation
  append_cols ..................................... None
  buckets ......................................... None
  checkpoint_dir .................................. _
  chief_hosts ..................................... 
  data_threads .................................... 10
  distributed_backend ............................. nccl
  do_lower_case ................................... False
  epoch_num ....................................... 3
  export_tf_checkpoint_type ....................... easytransfer
  first_sequence .................................. sent
  gradient_accumulation_steps ..................... 1
  input_schema .................................... index:str:1,sent:str:1,label:str:1
  is_chief ........................................ 
  is_master_node .................................. True
  job_name ........................................ None
  label_enumerate_values .......................... None
  label_name ...................................... None
  learning_rate ................................... 5e-05
  local_rank ...................................... 0
  logging_steps ................................... 100
  master_port ..................................... 23456
  max_grad_norm ................................... 1.0
  mg_model ........................................ False
  micro_batch_size ................................ 8
  mode ............................................ predict
  modelzoo_base_dir ............................... 
  n_cpu ........................................... 1
  n_gpu ........................................... 0
  odps_config ..................................... None
  optimizer_type .................................. AdamW
  output_schema ................................... augmented_data
  outputs ......................................... tmp/train_aug.tsv
  predict_queue_size .............................. 1024
  predict_slice_size .............................. 4096
  predict_table_read_thread_num ................... 16
  predict_thread_num .............................. 1
  ps_hosts ........................................ 
  random_seed ..................................... 1234
  rank ............................................ 0
  read_odps ....................................... False
  restore_works_dir ............................... ./.easynlp_predict_restore_works_dir
  resume_from_checkpoint .......................... None
  save_all_checkpoints ............................ False
  save_checkpoint_steps ........................... None
  second_sequence ................................. None
  sequence_length ................................. 128
  skip_first_line ................................. False
  tables .......................................... tmp/train_head.tsv
  task_count ...................................... 1
  task_index ...................................... 0
  use_amp ......................................... False
  use_torchacc .................................... False
  user_defined_parameters ......................... pretrain_model_name_or_path=bert-small-uncased type=mlm_da expansion_rate=2 mask_proportion=0.1 remove_blanks=True append_original=True
  user_entry_file ................................. None
  user_script ..................................... None
  warmup_proportion ............................... 0.1
  weight_decay .................................... 0.0001
  worker_count .................................... 1
  worker_cpu ...................................... -1
  worker_gpu ...................................... -1
  worker_hosts .................................... None
  world_size ...................................... 1
-------------------- end of arguments ---------------------
> initializing torch distributed ...
[W socket.cpp:558] [c10d] The client socket cannot be initialized to connect to [localhost]:52463 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:558] [c10d] The client socket cannot be initialized to connect to [localhost]:52463 (errno: 97 - Address family not supported by protocol).
Init dist done. World size: 1, rank 0, l_rank 0
> setting random seeds to 1234 ...
`/home/zhoujiyong.zjy/.easynlp/modelzoo/public/bert-small-uncased.tgz` already exists

 Loaded weights of the model:
 [bert.embeddings.word_embeddings.weight,bert.embeddings.position_embeddings.weight,bert.embeddings.token_type_embeddings.weight,bert.embeddings.LayerNorm.weight,bert.embeddings.LayerNorm.bias,bert.encoder.layer.0.attention.self.query.weight,bert.encoder.layer.0.attention.self.query.bias,bert.encoder.layer.0.attention.self.key.weight,bert.encoder.layer.0.attention.self.key.bias,bert.encoder.layer.0.attention.self.value.weight,bert.encoder.layer.0.attention.self.value.bias,bert.encoder.layer.0.attention.output.dense.weight,bert.encoder.layer.0.attention.output.dense.bias,bert.encoder.layer.0.attention.output.LayerNorm.weight,bert.encoder.layer.0.attention.output.LayerNorm.bias,bert.encoder.layer.0.intermediate.dense.weight,bert.encoder.layer.0.intermediate.dense.bias,bert.encoder.layer.0.output.dense.weight,bert.encoder.layer.0.output.dense.bias,bert.encoder.layer.0.output.LayerNorm.weight,bert.encoder.layer.0.output.LayerNorm.bias,bert.encoder.layer.1.attention.self.query.weight,bert.encoder.layer.1.attention.self.query.bias,bert.encoder.layer.1.attention.self.key.weight,bert.encoder.layer.1.attention.self.key.bias,bert.encoder.layer.1.attention.self.value.weight,bert.encoder.layer.1.attention.self.value.bias,bert.encoder.layer.1.attention.output.dense.weight,bert.encoder.layer.1.attention.output.dense.bias,bert.encoder.layer.1.attention.output.LayerNorm.weight,bert.encoder.layer.1.attention.output.LayerNorm.bias,bert.encoder.layer.1.intermediate.dense.weight,bert.encoder.layer.1.intermediate.dense.bias,bert.encoder.layer.1.output.dense.weight,bert.encoder.layer.1.output.dense.bias,bert.encoder.layer.1.output.LayerNorm.weight,bert.encoder.layer.1.output.LayerNorm.bias,bert.encoder.layer.2.attention.self.query.weight,bert.encoder.layer.2.attention.self.query.bias,bert.encoder.layer.2.attention.self.key.weight,bert.encoder.layer.2.attention.self.key.bias,bert.encoder.layer.2.attention.self.value.weight,bert.encoder.layer.2.attention.self.value.bias,bert.encoder.layer.2.attention.output.dense.weight,bert.encoder.layer.2.attention.output.dense.bias,bert.encoder.layer.2.attention.output.LayerNorm.weight,bert.encoder.layer.2.attention.output.LayerNorm.bias,bert.encoder.layer.2.intermediate.dense.weight,bert.encoder.layer.2.intermediate.dense.bias,bert.encoder.layer.2.output.dense.weight,bert.encoder.layer.2.output.dense.bias,bert.encoder.layer.2.output.LayerNorm.weight,bert.encoder.layer.2.output.LayerNorm.bias,bert.encoder.layer.3.attention.self.query.weight,bert.encoder.layer.3.attention.self.query.bias,bert.encoder.layer.3.attention.self.key.weight,bert.encoder.layer.3.attention.self.key.bias,bert.encoder.layer.3.attention.self.value.weight,bert.encoder.layer.3.attention.self.value.bias,bert.encoder.layer.3.attention.output.dense.weight,bert.encoder.layer.3.attention.output.dense.bias,bert.encoder.layer.3.attention.output.LayerNorm.weight,bert.encoder.layer.3.attention.output.LayerNorm.bias,bert.encoder.layer.3.intermediate.dense.weight,bert.encoder.layer.3.intermediate.dense.bias,bert.encoder.layer.3.output.dense.weight,bert.encoder.layer.3.output.dense.bias,bert.encoder.layer.3.output.LayerNorm.weight,bert.encoder.layer.3.output.LayerNorm.bias,bert.pooler.dense.weight,bert.pooler.dense.bias,cls.predictions.bias,cls.predictions.transform.dense.weight,cls.predictions.transform.dense.bias,cls.predictions.transform.LayerNorm.weight,cls.predictions.transform.LayerNorm.bias,cls.predictions.decoder.weight,cls.predictions.decoder.bias,cls.seq_relationship.weight,cls.seq_relationship.bias].


 Unloaded weights of the model:
 [cls.seq_relationship.weight,cls.seq_relationship.bias]. 
 This IS expected if you initialize A model from B.
 This IS NOT expected if you initialize A model from A.

0it [00:00, ?it/s]1it [00:00,  4.60it/s]2it [00:00,  4.54it/s]3it [00:00,  4.69it/s]4it [00:00,  4.78it/s]5it [00:01,  4.80it/s]6it [00:01,  4.84it/s]7it [00:01,  4.86it/s]8it [00:01,  4.86it/s]8it [00:01,  4.80it/s]
[2022-12-07 12:00:52,114 INFO] Duration time: 2.3603076934814453 s
NOTE: if you wish to use GLM models, please refer to EasyNLP/examples/appzoo_tutorials/sequence_generation/README.md!
The following parameters are not recognized: []
Trying downloading name_mapping.json
Success
`/home/zhoujiyong.zjy/.easynlp/modelzoo/public/bert-small-uncased.tgz` already exists
python -m torch.distributed.launch --nproc_per_node 1 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 52463 /home/zhoujiyong.zjy/.local/lib/python3.8/site-packages/pai_easynlp-0.1.0-py3.8.egg/easynlp/appzoo/api.py --mode predict --tables tmp/train_head.tsv --input_schema index:str:1,sent:str:1,label:str:1 --first_sequence sent --checkpoint_dir _ --export_tf_checkpoint_type easytransfer --learning_rate 5e-05 --epoch_num 3 --random_seed 1234 --predict_queue_size 1024 --predict_slice_size 4096 --predict_thread_num 1 --outputs tmp/train_aug.tsv --output_schema augmented_data --restore_works_dir ./.easynlp_predict_restore_works_dir --sequence_length 128 --micro_batch_size 8 --app_name data_augmentation --user_defined_parameters pretrain_model_name_or_path=bert-small-uncased type=mlm_da expansion_rate=2 mask_proportion=0.1 remove_blanks=True append_original=True
